\documentclass[a4paper,11pt]{article}

\usepackage{textalpha}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{makecell}

\title{1\textsuperscript{η} Υποχρεωτική Εργασία Στο Μάθημα της Αριθμητικής Ανάλυσης}

\author{Ονοματεπώνυμο: Βίκτωρ Κυρτσούδης \\ ΑΕΜ: 4143}

\date{}

\begin{document}

\maketitle

\begin{flushleft}
\boldmath

\section*{Άσκηση 1}
\begin{figure}[h]
    \caption*{Γραφική παράσταση των $f(x) = e^{sin^3x}+x^6-2x^4-x^3-1$ και \textbf{f'}}
    \includegraphics[width=\textwidth]{ex1plot.png}
\end{figure}

Από το γράφημα παρατηρούμε ότι:
\begin{enumerate}
    \item Η f φαίνεται να έχει ρίζες κοντά στα $x_1=-1$, $x_2=0$ και $x_3=1.5$.
    \item Η f' έχει ρίζα στο 0.
\end{enumerate}

Για τον υπολογισμό των ριζών δημιουργήθηκαν σε Matlab το πρόγραμμα ex1.m και οι συναρτήσεις bisection, newton και secant.

\textbf{Στο ex1} ορίζεται μία συμβολική συνάρτηση f με τον αντίστοιχο τύπο, κατασκευάζεται το παραπάνω γράφημα και στην συνέχεια καλούνται με τη σειρά οι τρεις συναρτήσεις για να υπολογίσουν την κάθε ρίζα και των αριθμό των επαναλήψεων που χρειάζονται για να τις προσεγγίσουν. Τα αποτελέσματα για κάθε μέθοδο αποθηκεύονται στους πίνακες bisectionRoots, newtonRoots και secantRoots.
\linebreak

    
    
\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        \multirow{2}{*}{Μέθοδος} & -1.1976 & 0.0000 & 1.5301 \\ \cline{2-4}  & \multicolumn{3}{c|}{Επαναλήψεις} \\
        \hline
        Bisection & 18 & - & 18 \\ \hline
        Newton & 8 & 36 & 7 \\  \hline
        Secant & 14 & 55 & 10 \\ \hline
    \end{tabular}
\end{table}

\subsection*{Διχοτόμηση}
Η συνάρτηση bisection δέχεται την συνάρτηση $f$, το μέγιστο επιτρεπόμενο σφάλμα και τα ακρά του διαστήματος στο οποίο θα γίνει η αναζήτηση. Αφού υπολογίσει τον ελάχιστο αριθμο των αναγκαίων επαναλήψεων με τον τύπο 
$N > \frac{\ln{\frac{b-a}{\epsilon}}}{\ln{2}}$ 
ελέγχει αν το μέσο του διαστήματος είναι ρίζα της $f$ και αν ναι σταματάει και επιστρέφει τα αντίστοιχα αποτελέσματα. Αν δεν είναι αποφασίζει αν θα αντικαταστήσει το αριστερό ή το δεξί άκρο του διαστήματος με το μέσο δεδομένου ότι μετά την αντικατάσταση πρέπει να ισχύει: $f(a)f(b)<0$. Και επαναλαμβάνει μέχρι να βρει την ρίζα ή να φτάσει τις $N$ Επαναλήψεις.
\linebreak

Χρησιμοποιούμε την μέθοδο της διχοτόμησης μόνο για την αναζήτηση των ριζών κοντά στο -1 και στο 1.5 γιατί κοντά στο 0 δεν υπάρχει διάστημα $[a,b]$ που να ισχύει $f(a)f(b)<0$
\linebreak

\subsection*{Newton-Raphson}
Η συνάρτηση newton δέχεται την συνάρτηση $f$, το μέγιστο επιτρεπόμενο σφάλμα και το αρχικό σημείο $x_0$. Αρχικά υπολογίζει την νέα προσέγγιση με τον επαναληπτικό τύπο $x_{n+1} = x_n-\frac{f(x_n)}{f'(x_n)}$ και την διαφορά των προσεγγίσεων. Μετά ξεκινάει η επαναληπτική διαδικασία κατά την οποία ελέγχει αν η διαφορά είναι μεγαλύτερη του μέγιστου επιτρεπόμενου σφάλματος. Αν δεν είναι τερματίζει και επιστρέφει τα αποτελέσματα. Αν είναι υπολογίζει την νέα προσέγγιση και διαφορά. Αν η καινούρια διαφορά των τελευταίων προσεγγίσεων είναι μεγαλύτερη από την προηγούμενη τότε σημαίνει ότι δεν συγκλίνει οπότε σταματάει και επιστρέφει $NaN$ στην προσέγγιση και $0$ στις επαναλήψεις.
\linebreak

Παρόλο που στο 0 δεν υπάρχει διάστημα που να ικανοποιεί τις συνθήκες του θεωρήματος ύπαρξης μοναδικής ρίζας (δηλ. $f'(x),f''(x)\neq0$ για κάθε $x\in[a,b]$ και $f(a)f(b)<0$) η Newton-Raphson επιστρέφει τα σωστά αποτελέσματα.
Επειδή όμως το 0 είναι ρίζα και της $f'$ (από το γράφημα) προκύπει ότι σε αντίθεση με τις ρίζες -1.1976 και 1.5301 δεν συγκλίνει τετραγωνικά στο 0 γι' αυτό και χρειάζονται τόσες παραπάνω επαναλήψεις.
\linebreak

\subsection*{Τέμνουσα}
Η συνάρτηση secant δέχεται την συνάρτηση $f$, το μέγιστο επιτρεπόμενο σφάλμα και τις αρχικές προσεγγίσεις $x_0$ και $x_1$. Μέχρι οι διαφορά των δύο τελευταίων προσεγγίσεων να γίνει μικρότερη του σφάλματος επαναλαμβάνει την εξής διαδικασία: υπολογίζει την νέα προσέγγιση με βάση τις προηγούμενες δύο χρησιμοποιώντας τον τύπο $x_{n+1} = x_n-\frac{f(x_n)(x_n-x_{n-1})}{f(x_n)-f(x_{n-1})}$ και μόλις γίνει αυτό επιστρέφει τα αποτελέσματα. 
\linebreak
Στο 0 ισχύει ό,τι ισχύει και στην Newton-Raphson.


\section*{Άσκηση 2}
Για την επίλυση των ζητουμένων στο διάστημα $[0,3]$ πάνω στην συνάρτηση $$f(x) = 94cos^3x-24cosx+177sin^2x-108sin^4x-72cos^3x*sin^2x-65$$  δημιουργήθηκαν σε Matlab το πρόγραμμα ex2.m και οι συναρτήσεις modifiedBisection, modifiedNewton και modifiedSecant.

\subsection*{Τροποποιημένη Διχοτόμηση}
Η τροποποιημένη μέθοδος της διχοτόμησης αντί να επιλέγει το μέσο του διαστήματος σαν νέα προσέγγιση επιλέγει τυχαία έναν αριθμό μέσα από αύτο. Αυτό σημαίνει ότι το διάστημα δεν μειώνεται με σταθερό ρυθμό κι έτσι δεν μπορούμε να γνωρίζουμε απ' την αρχή πόσες επαναλήψεις χρειάζονται για την εύρεση της προσέγγισης με αποδεκτό σφάλμα για αυτό και η νέα τερματική συνθήκη είναι η διαφορά των δύο τελευταίων προσεγγίσεων να είναι μικρότερη του μέγιστου αποδεκτού σφάλματος.
\linebreak


\subsection*{Τροποποιημένη Newton-Raphson}
Η τροποποιημένη μέθοδος Newton-Raphson κάνει ακριβώς ότι και η απλή μέθοδος Newton αλλά η συνάρτηση $\phi$ έχει τον τύπο $$x_{n+1} = x_n-\frac{1}{\frac{f'(x_n)}{f(x_n)}-\frac{1}{2}\frac{f''(x_n)}{f'(x_n)}}$$
\linebreak

\subsection*{Τροποποιημένη Τέμνουσα}
Η τροποποιημένη μέθοδος της Τέμνουσας επίσης μοιάζει με την απλή μέθοδο Τέμνουσας με την διαφορά ότι η συνάρτηση $\phi$ δεν βρίσκει το σημείο στο οποίο τέμνει τον άξονα $x'x$ η ευθεία που περνάει από τις δύο τελευταίες προσεγγίσεις αλλά η παραβολή που περνάει από τις τρεις τελευταίες και έχει τον τύπο: 
$$x_{n+3} = x_{n+2} - \frac{r(r-q)(x_{n+2}-x_{n+1})+(1-r)s(x_{n+2}-x_n)}{(q-1)(r-1)(s-1)}$$
όπου $r = \frac{f(x_{n+2})}{f(x_{n+1})}$, $q = \frac{f(x_n)}{f(x_{n+1})}$ και $s = \frac{f(x_{n+2})}{f(x_n)}$.
\linebreak

\textbf{Στο ex2} ορίζεται πάλι μία συμβολική συνάρτηση f και όπως και στην 1\textsuperscript{η} άσκηση καλούμε τις 3 συναρτήσεις για να επιστρέψουν την προσέγγιση στην οποία καταλήγουν και τις επαναλήψεις που χρειάστηκαν. Αυτό γίνεται και με τις τρεις συναρτήσεις της 1\textsuperscript{ης} άσκησης και τα αποτελέσματα αποθηκεύονται αντίστοιχα στους πίνακες: 
\begin{itemize}
    \item modifiedNewtonRoots
    \item modifiedBisectionRoots
    \item modifiedSecantRoots
    \item newtonRoots
    \item bisectionRoots
    \item secantRoots
\end{itemize}

Οι ρίζες είναι κοντά στο 0.8, στο 1 και στο 2.3 για αυτό και οι αναζητήσεις γίνονται κοντά σε αυτά τα σημεία και τα αποτελέσματα που προκύπτουν είναι:

\begin{center}
    \begin{tabular}{|c|c|c|c|c|c|}
        \hline
        Μέθοδος & Προσέγγιση & Επαναλήψεις\\ \Xhline{4\arrayrulewidth}
        \multirow{3}{*}{modifiedNewtonRoots} & 0.8411 & 4 \\ \cline{2-3} & 1.0472 & 14 \\ \cline{2-3} & 2.3005 & 3 \\ \Xhline{4\arrayrulewidth}
        \multirow{3}{*}{modifiedBisectionRoots} & 0.8411 & 20 \\ \cline{2-3} & 1.0472 & 27 \\ \cline{2-3} & 2.3005 & 19 \\ \Xhline{4\arrayrulewidth}
        \multirow{3}{*}{modifiedSecantRoots} & 0.8411 & 5 \\ \cline{2-3} & 1.0540 & 11 \\ \cline{2-3} & 2.3005 & 5 \\ \Xhline{4\arrayrulewidth}
        \multirow{3}{*}{newtonRoots} & 0.8411 & 5 \\ \cline{2-3} & 1.0472 & 22 \\ \cline{2-3} & 2.3005 & 4 \\ \Xhline{4\arrayrulewidth}
        \multirow{3}{*}{bisectionRoots} & 0.8411 & 16 \\ \cline{2-3} & 1.0472 & 16 \\ \cline{2-3} & 2.3005 & 16 \\ \Xhline{4\arrayrulewidth}
        \multirow{3}{*}{secantRoots} & 0.8411 & 9 \\ \cline{2-3} & 1.0472 & 35 \\ \cline{2-3} & 2.3005 & 6 \\ \Xhline{4\arrayrulewidth}
    \end{tabular}
\end{center}
    
    
    Στην συνέχεια αποθηκεύονται στον πίνακα repsOfModifiedBisection 10 φορές οι επαναλήψεις που χρειάζεται η τροποποιημένη μέθοδος της διχοτόμησης για να βρει την ρίζα στο 0.8 και έτσι μπορούμε να παρατηρήσουμε ότι η τροποποιημένη μέθοδος δεν συγκλίνει σε σταθερό αριθμό επαναλήψεων. Κάτι που είναι αναμενόμενο εφόσων η νέα προσέγγιση επιλέγεται στην τύχη μέσα από το διαάστημα. 
    
\begin{center}
    Επαναλήψεις τις τροποποιημένης μεθόδου Διχοτόμησης
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        20 & 13 & 20 & 27 & 19 & 15 & 17 & 21 & 15 & 22 \\
        \hline
    \end{tabular}
\end{center}

Τέλος, στους πίνακες:
\begin{itemize}
    \item differenceOfConvergenceSpeedOfBisection
    \item differenceOfConvergenceSpeedOfNewton
    \item differenceOfConvergenceSpeedOfSecant
\end{itemize} 
αποθηκεύονται πόσο περισσότερες επαναλήψεις χρειάζονται	οι τροποποιημένες μέθοδοι για να προσεγγίσουν τις ρίζες. 
\linebreak
Οι αρνητικοί αριθμοί σημαίνουν ότι χρειάζονται λιγότερες επαναλήψεις.

\begin{center}
    \begin{tabular}{|c|c|}
        \hline
        \multirow{3}{*}{differenceOfConvergenceSpeedOfBisection} & 6 \\ \cline{2-2} & 15 \\ \cline{2-2} & 3 \\ \hline
        \multirow{3}{*}{differenceOfConvergenceSpeedOfNewton} & -1 \\ \cline{2-2} & -8 \\ \cline{2-2} & -1 \\ \hline
        \multirow{3}{*}{differenceOfConvergenceSpeedOfSecant} & -4 \\ \cline{2-2} & -24 \\ \cline{2-2} & -1 \\ \hline   
    \end{tabular}
\end{center}

Παρατηρούμε ότι η τροποποιημένη μέθοδος Διχοτόμησης είναι πιο αργή από την απλή σε αντίθεση με τις τροποποιημένες Newton-Raphson και Τέμνουσας. Αλλά η τρεις ρίζες μίας συνάρτησης ειναί πολύ μικρό δείγμα για να βγει γενικό συμπέρασμα. 

\section*{Άσκηση 3}
Για την λύση του \textbf{πρώτου υποερωτήματος} δημιουργήθηκε η συνάρτηση gauss.m σε Matlab η οποία δέχεται τον πίνακα $A$ και το διάνυσμα $b$ του γραμμικού συστήματος $Ax = b$, το λύνει με την μέθοδο $PA = LU$ και επιστρέφει το διάνυσμα των αγνώστων $x$.
\linebreak
Αρχικά αντιγράφει τον πίνακα $A$ στον $U$. Μετά κάνει οδήγηση στον $U$ για να έχει έτοιμο τον πινακα $P$ και στην συνέχεια υπολογίζει τον πίνακα $L$ κάνοντας gauss στον $U$. Έπειτα υπολογίζει το διάνυσμα $z = Pb$ και κάνει εμπρόσθια αντικατάσταση με τον $L$ για να βρει το διάνυσμα $y = Ux$ και τέλος κάνει οπισθοδρόμηση στο σύστημα $Ux=y$ (αφού ο $U$ είναι άνω τριγωνικός) για να βρει το $x$.
\linebreak

Για την λύση του \textbf{δεύτερου υποερωτήματος} δημιουργήθηκε η συνάρτηση cholesky.m σε Matlab η οποία δέχεται έναν πίνακα $A$ συμμετρικό και θετικά ορισμένο και επιστρέφει τον κάτω τριγωνικό πίνακα $L$ που αποτελεί την αποσύνθεση Cholesky του $A$.
\linebreak

Για το \textbf{τρίτο υποερώτημα} δημιουργήθηκε το πρόγραμμα ex3.m και η συνάρτηση gaussSeidel.m καθώς και η βοηθητική συνάρτηση makeAb.m
\linebreak
Στο ex3 κατσκευάζονται με την βοήθεια της makeAb και επιλύονται με την βοήθεια της gaussSeidel αρχικά για n = 10 και μετά για n = 10,000 ο πίνακας $A$ και το διάνυσμα $b$ με $A(i,i) = 5, A(i+1,i) = A(i,i+1) = -2$ και $b = [3,1,1,\dots,1,1,3]^T$
\linebreak
Η συνάρτηση gaussSeidel προσεγγίζει σύμφωνα με την μέθοδο Gauss-Seidel την λύση του γραμμικού συστήματος $Ax=b$ με σφάλμα $\epsilon < \frac{1}{2}10^{-4}$.
Το σφάλμα πρέπει να είναι μικρότερο της άπειρης νόρμας της διαφοράς των δύο τελευταίων προσεγγίσεων.
\end{flushleft}
\end{document}